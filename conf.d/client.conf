#
#            __                    _ 
#           / _|                  | |
#  _ __ ___| |_ ___ _ __ _ __ __ _| |
# | '__/ _ \  _/ _ \ '__| '__/ _` | |
# | | |  __/ ||  __/ |  | | | (_| | |
# |_|  \___|_| \___|_|  |_|  \__,_|_|
#

# client configs
# by michael hoyt 
# email: base64(bWUgW0B0XSBpZGdhZiBbZDB0XSBtZQ==)
# web:   base64(aHR0cHM6Ly9pZGdhZi5tZQ==)





# $client_allow
# @in:  $http_client [client]
# @out: deny / allow
#
# @desc: firewalls requests based on client


# Cloudflare

allow 103.21.244.0/22;
allow 103.22.200.0/22;
allow 103.31.4.0/22;
allow 104.16.0.0/12;
allow 108.162.192.0/18;
allow 141.101.64.0/18;
allow 162.158.0.0/15;
allow 172.64.0.0/13;
allow 173.245.48.0/20;
allow 188.114.96.0/20;
allow 190.93.240.0/20;
allow 197.234.240.0/22;
allow 198.41.128.0/17;
allow 199.27.128.0/21;

# OVH France - SAS

deny 5.39.0.0/17;   
deny 5.135.0.0/16; 
deny 5.196.0.0/16; 
deny 37.59.0.0/16; 
deny 37.187.0.0/16;
deny 46.105.0.0/16;
deny 46.105.192.0/20;
deny 46.105.192.0/23;
deny 46.105.194.0/23;
deny 46.105.196.0/23;
deny 46.105.198.0/24;
deny 87.98.128.0/17;
deny 91.121.0.0/16;
deny 92.222.0.0/16;
deny 94.23.0.0/16;
deny 149.202.0.0/16;
deny 151.80.0.0/16;
deny 176.31.0.0/16;
deny 176.31.160.0/22;
deny 176.31.176.0/22;
deny 176.31.184.0/22;
deny 176.31.188.0/22;
deny 178.32.0.0/15;
deny 178.32.133.0/24;
deny 178.32.134.0/24;
deny 178.32.135.0/24;
deny 188.165.0.0/16;
deny 213.186.32.0/19;
deny 213.251.128.0/18;

# SMTP.FR - EMAILING SERVICES (OVH)

deny 37.60.48.0/21; 
deny 37.60.56.0/21;

# OVH Hosting, Inc. (US)

deny 8.7.244.0/24;
deny 8.18.128.0/24;
deny 8.18.136.0/21;
deny 8.18.172.0/24;
deny 8.20.110.0/24;
deny 8.21.41.0/24;
deny 8.24.8.0/21;
deny 8.26.94.0/24;
deny 8.29.224.0/24;
deny 8.30.208.0/21;
deny 8.33.96.0/21;
deny 8.33.128.0/21;
deny 8.33.136.0/24;
deny 8.33.137.0/24;

# OVH Hosting, Inc. (CA)

deny 142.4.192.0/19;
deny 167.114.0.0/16;
deny 192.95.0.0/18;
deny 192.95.18.0/24;
deny 192.99.0.0/16;
deny 198.27.64.0/18;
deny 198.50.128.0/17;
deny 198.50.175.0/24;
deny 198.100.144.0/20;
deny 198.245.48.0/20;